# 요구사항 명세서 (Requirements Specification)

## 1. 프로젝트 개요

### 1.1. 목적

AI 기반 영어 학습 도구를 제공하여 사용자가 영어 단어와 문장을 효과적으로 학습할 수 있도록 지원하는 웹 애플리케이션을 개발한다.

### 1.2. 범위

- 영어 단어 기반 스토리 생성
- 영어 단어 기반 예문 생성
- TTS(Text-to-Speech) 기능을 통한 음성 학습 지원
- HTML 태그를 통한 시각적 강조 기능
- 다중 LLM 프로바이더 지원

### 1.3. 주요 이해관계자

- **최종 사용자**: 영어 학습자
- **개발팀**: 프론트엔드/백엔드 개발자
- **운영팀**: DevOps 엔지니어

## 2. 기능 요구사항

### 2.1. 영어 스토리 생성 기능

#### 2.1.1. 기본 기능

- **FR-001**: 사용자는 1-5개의 영어 단어를 입력할 수 있어야 한다.
- **FR-002**: 사용자는 난이도(초급, 중급, 고급)를 선택할 수 있어야 한다.

- **FR-003**: 시스템은 입력된 단어들을 모두 포함하는 영어 스토리를 생성해야 한다.
- **FR-004**: 생성된 스토리는 선택된 난이도에 적합한 어휘와 문법 구조를 사용해야 한다.

#### 2.1.2. 스토리 품질 요구사항

- **FR-005**: 스토리는 논리적으로 일관되고 흥미로운 내용이어야 한다.
- **FR-006**: 스토리 길이는 난이도에 따라 조절되어야 한다.
  - 초급: 50-100단어

  - 중급: 100-150단어
  - 고급: 150-200단어
- **FR-007**: 입력된 모든 단어는 스토리에서 자연스럽게 사용되어야 한다.

#### 2.1.3. 시각적 강조 기능

- **FR-008**: 스토리에서 중요한 단어들은 HTML 태그로 시각적으로 강조되어야 한다.
- **FR-009**: 입력된 키워드는 빨간색(`#e74c3c`)으로 강조되어야 한다.

- **FR-010**: 어려운 단어는 파란색(`#3498db`)으로 강조되어야 한다.
- **FR-011**: 강조된 텍스트는 굵은 글씨체(`font-weight: bold`)로 표시되어야 한다.

### 2.2. 영어 예문 생성 기능

#### 2.2.1. 기본 기능

- **FR-012**: 사용자는 영어 단어를 입력할 수 있어야 한다.
- **FR-013**: 시스템은 입력된 단어를 사용하는 다양한 예문을 생성해야 한다.
- **FR-014**: 예문은 일상생활에서 활용 가능한 실용적인 내용이어야 한다.

#### 2.2.2. 예문 품질 요구사항

- **FR-015**: 생성된 예문은 문법적으로 정확해야 한다.
- **FR-016**: 예문은 다양한 문형(평서문, 의문문, 감탄문 등)을 포함해야 한다.
- **FR-017**: 각 예문은 명확하고 이해하기 쉬운 내용이어야 한다.

### 2.3. TTS(Text-to-Speech) 기능

#### 2.3.1. 기본 기능

- **FR-018**: 생성된 영어 텍스트를 음성으로 재생할 수 있어야 한다.
- **FR-019**: TTS 기능은 브라우저 네이티브 Web Speech API를 사용해야 한다.
- **FR-020**: 음성은 영어 네이티브 발음으로 재생되어야 한다.

#### 2.3.2. 사용자 경험 요구사항

- **FR-021**: TTS 재생 버튼을 클릭하여 음성 재생을 시작할 수 있어야 한다.
- **FR-022**: HTML 태그가 포함된 텍스트의 경우 태그를 제거한 순수 텍스트만 음성으로 재생해야 한다.
- **FR-023**: 브라우저가 TTS를 지원하지 않는 경우 적절한 안내 메시지를 표시해야 한다.

### 2.4. 클립보드 복사 기능

#### 2.4.1. 기본 기능

- **FR-024**: 생성된 텍스트를 클립보드에 복사할 수 있어야 한다.
- **FR-025**: HTML 태그가 포함된 텍스트의 경우 태그를 제거한 순수 텍스트만 복사해야 한다.
- **FR-026**: 복사 완료 시 사용자에게 피드백을 제공해야 한다.

### 2.5. LLM 통합 기능

#### 2.5.1. 다중 프로바이더 지원

- **FR-027**: 시스템은 여러 LLM 프로바이더를 지원해야 한다.
  - OpenAI (GPT-4, GPT-3.5-turbo)
  - Google Gemini Pro
  - Anthropic Claude
- **FR-028**: 주요 프로바이더 실패 시 자동으로 대체 프로바이더로 전환해야 한다.

- **FR-029**: 프로바이더 선택은 환경변수를 통해 설정할 수 있어야 한다.

#### 2.5.2. API 응답 표준화

- **FR-030**: 모든 LLM 프로바이더의 응답은 표준화된 형식으로 변환되어야 한다.

- **FR-031**: 응답에는 사용된 프로바이더 정보가 포함되어야 한다.
- **FR-032**: 토큰 사용량 정보가 제공되는 경우 이를 로깅해야 한다.

### 2.6. 출력 및 데이터 관리 기능

#### 2.6.1. 프린트 출력 기능

- **FR-033**: 생성된 스토리를 프린트용 형식으로 출력할 수 있어야 한다.
- **FR-034**: 프린트 출력 시 다음 정보가 포함되어야 한다:
  - 생성된 영어 스토리 (입력된 단어는 굵은 글씨체로 강조 유지)
  - 한국어 번역
  - 사용된 영어 단어 목록과 한국어 의미
  - 난이도 정보
  - 생성 날짜 및 시간
- **FR-035**: 프린트 출력은 A4 용지 크기에 최적화되어야 한다.
- **FR-036**: 프린트 출력 시 웹 페이지의 불필요한 UI 요소(버튼, 메뉴 등)는 제외되어야 한다.
- **FR-037**: 프린트 출력에서 입력된 영어 단어는 다음과 같이 강조되어야 한다:
  - 굵은 글씨체 (font-weight: bold)
  - 밑줄 (text-decoration: underline) 또는 배경색 강조
- **FR-038**: 프린트 출력 시 색상은 흑백 프린터에서도 구분 가능하도록 텍스트 스타일로 표현되어야 한다.

#### 2.6.2. Excel 파일 출력 기능

- **FR-039**: 사용자가 입력한 영어 단어와 한국어 의미를 Excel 파일로 내보낼 수 있어야 한다.
- **FR-040**: Excel 파일은 다음 열을 포함해야 한다:
  - 영어 단어 (English Word)
  - 한국어 의미 (Korean Meaning)
  - 사용된 스토리 제목 (Story Title, 선택사항)
  - 생성 날짜 (Creation Date)
- **FR-041**: Excel 파일명은 'english-words-[YYYY-MM-DD].xlsx' 형식으로 자동 생성되어야 한다.
- **FR-042**: Excel 파일 다운로드는 브라우저의 기본 다운로드 폴더에 저장되어야 한다.

#### 2.6.3. Excel 파일 입력 기능

- **FR-043**: 사용자는 Excel 파일을 업로드하여 영어 단어와 한국어 의미를 일괄 입력할 수 있어야 한다.
- **FR-044**: 업로드 가능한 Excel 파일 형식은 .xlsx 및 .xls여야 한다.
- **FR-045**: Excel 파일의 첫 번째 행은 헤더로 인식하고 건너뛰어야 한다.
- **FR-046**: Excel 파일에서 다음 열을 인식해야 한다:
  - A열 또는 'English Word' 헤더: 영어 단어 (필수)
  - B열 또는 'Korean Meaning' 헤더: 한국어 의미 (필수)
- **FR-047**: 업로드된 Excel 파일에서 최대 20개의 단어까지 인식해야 한다.
- **FR-048**: 잘못된 형식의 Excel 파일 업로드 시 적절한 오류 메시지를 표시해야 한다.
- **FR-049**: Excel 파일 업로드 후 기존에 입력된 단어는 업로드된 내용으로 대체되어야 한다.
- **FR-050**: 시스템에서 생성된 Excel 파일(FR-039~FR-042)을 다시 업로드하여 재사용할 수 있어야 한다.
- **FR-051**: Excel 파일 업로드 시 드래그 앤 드롭 방식을 지원해야 한다.
- **FR-052**: Excel 파일 업로드 전에 미리보기 기능을 제공하여 인식될 데이터를 확인할 수 있어야 한다.
- **FR-053**: Excel 파일에서 빈 행이나 빈 셀이 있는 경우 자동으로 건너뛰어야 한다.
- **FR-054**: 업로드된 Excel 파일에서 중복된 영어 단어가 있는 경우 사용자에게 경고 메시지를 표시해야 한다.
- **FR-055**: Excel 파일 업로드 시 파일 크기 제한(최대 5MB)을 확인하고 초과 시 적절한 오류 메시지를 표시해야 한다.
- **FR-056**: Excel 파일에 'Story Title', 'Creation Date' 등의 추가 열이 있는 경우 이를 무시하고 영어 단어와 한국어 의미만 처리해야 한다.
- **FR-058**: 업로드된 Excel 파일에서 특수문자나 이모지가 포함된 단어는 적절히 처리하거나 사용자에게 확인을 요청해야 한다.
- **FR-059**: Excel 파일에서 20개를 초과하는 단어가 있는 경우 처음 20개만 처리하고 사용자에게 안내 메시지를 표시해야 한다.
- **FR-060**: Excel 파일 업로드 시 사용자에게 올바른 파일 형식과 스키마 가이드를 제공해야 한다:
  - 지원 파일 형식: .xlsx, .xls
  - 필수 열 구조: A열(English Word), B열(Korean Meaning)
  - 첫 번째 행은 헤더로 사용 (선택사항)
  - 최대 20개 단어까지 처리
  - 파일 크기 제한: 5MB 이하
  - 추가 열(Story Title, Creation Date 등)이 있어도 무시하고 처리

## 3. 비기능 요구사항

### 3.1. 성능 요구사항

#### 3.1.1. 응답 시간

- **NFR-001**: LLM API 호출을 제외한 시스템 처리 시간은 1초 이내여야 한다.
- **NFR-002**: 전체 응답 시간(LLM API 포함)은 10초 이내여야 한다.

- **NFR-003**: TTS 재생은 버튼 클릭 후 1초 이내에 시작되어야 한다.

#### 3.1.2. 동시성

- **NFR-004**: 시스템은 최소 100명의 동시 사용자를 지원해야 한다.
- **NFR-005**: 서버리스 함수는 콜드 스타트 시간을 최소화해야 한다.

### 3.2. 보안 요구사항

#### 3.2.1. API 키 보안

- **NFR-006**: LLM API 키는 클라이언트에 노출되어서는 안 된다.
- **NFR-007**: API 키는 환경변수로 관리되어야 한다.
- **NFR-008**: 더미 또는 무효한 API 키는 자동으로 필터링되어야 한다.

#### 3.2.2. 입력 검증

- **NFR-009**: 모든 사용자 입력은 서버 측에서 검증되어야 한다.
- **NFR-010**: XSS 공격을 방지하기 위한 입력 필터링이 적용되어야 한다.

### 3.3. 가용성 요구사항

#### 3.3.1. 시스템 가용성

- **NFR-011**: 시스템 가용성은 99.5% 이상이어야 한다.
- **NFR-012**: LLM 프로바이더 장애 시 대체 프로바이더로 자동 전환해야 한다.
- **NFR-013**: 시스템 장애 시 사용자 친화적인 에러 메시지를 제공해야 한다.

#### 3.3.2. 브라우저 호환성

- **NFR-014**: Chrome, Safari, Firefox, Edge 최신 버전을 지원해야 한다.
- **NFR-015**: Web Speech API를 지원하지 않는 브라우저에서도 기본 기능은 동작해야 한다.

### 3.4. 사용성 요구사항

#### 3.4.1. 사용자 인터페이스

- **NFR-016**: 직관적이고 사용하기 쉬운 인터페이스를 제공해야 한다.
- **NFR-017**: 모바일 및 태블릿에서도 사용 가능한 반응형 디자인을 적용해야 한다.

- **NFR-018**: 로딩 상태를 명확히 표시해야 한다.

#### 3.4.2. 파일 처리 성능

- **NFR-019**: Excel 파일 다운로드는 버튼 클릭 후 3초 이내에 완료되어야 한다.
- **NFR-020**: Excel 파일 업로드 처리는 5초 이내에 완료되어야 한다.
- **NFR-021**: 프린트 페이지 생성은 2초 이내에 완료되어야 한다.
- **NFR-022**: 업로드 가능한 Excel 파일 크기는 최대 5MB로 제한되어야 한다.
- **NFR-023**: Excel 파일 미리보기 생성은 2초 이내에 완료되어야 한다.
- **NFR-024**: Excel 파일 업로드 시 진행률 표시기를 제공하여 사용자 경험을 향상시켜야 한다.
- **NFR-025**: 대용량 Excel 파일(1000행 이상) 처리 시에도 브라우저가 블록되지 않아야 한다.
- **NFR-039**: Excel 파일에서 20개 초과 단어 검증 및 제한 처리는 1초 이내에 완료되어야 한다.
- **NFR-040**: Excel 파일 스키마 가이드 UI는 즉시 표시되어야 하며 로딩 시간이 없어야 한다.

#### 3.4.3. 접근성

- **NFR-026**: WCAG 2.1 AA 수준의 접근성 가이드라인을 준수해야 한다.
- **NFR-027**: TTS 기능을 통해 시각 장애인의 접근성을 향상시켜야 한다.
- **NFR-028**: Excel 파일 업로드 시 스크린 리더 사용자를 위한 적절한 레이블과 피드백을 제공해야 한다.

### 3.5. 유지보수성 요구사항

#### 3.5.1. 코드 품질

- **NFR-029**: TypeScript를 사용하여 타입 안정성을 확보해야 한다.
- **NFR-030**: 테스트 커버리지는 80% 이상이어야 한다.
- **NFR-031**: TDD(테스트 주도 개발) 방식으로 개발되어야 한다.

#### 3.5.2. 문서화

- **NFR-032**: API 문서는 자동으로 생성되고 최신 상태를 유지해야 한다.
- **NFR-033**: 코드 주석은 핵심 로직에 대해 충분히 제공되어야 한다.

#### 3.5.3. 파일 형식 지원

- **NFR-034**: Excel 파일 처리는 브라우저에서 직접 수행되어야 한다 (서버 업로드 없음).
- **NFR-035**: 지원되지 않는 파일 형식 업로드 시 명확한 오류 메시지를 제공해야 한다.
- **NFR-036**: 손상된 Excel 파일 처리 시 적절한 에러 핸들링을 수행해야 한다.
- **NFR-037**: Excel 파일 파싱 중 메모리 사용량이 브라우저 제한을 초과하지 않아야 한다.
- **NFR-038**: Excel 파일 업로드 중 사용자가 작업을 취소할 수 있는 기능을 제공해야 한다.

## 4. 제약사항

### 4.1. 기술적 제약사항

- **CON-001**: Next.js 프레임워크를 사용해야 한다.
- **CON-002**: 서버리스 아키텍처를 기반으로 구현해야 한다.

- **CON-003**: 별도의 데이터베이스는 사용하지 않는다.
- **CON-004**: TTS는 브라우저 네이티브 API만 사용한다.

### 4.2. 비즈니스 제약사항

- **CON-005**: LLM API 사용 비용을 최소화해야 한다.
- **CON-006**: 사용자 데이터는 저장하지 않는다.
- **CON-007**: 실시간 기능은 구현하지 않는다.

### 4.3. 파일 처리 제약사항

- **CON-008**: Excel 파일은 클라이언트 사이드에서만 처리되어야 한다.
- **CON-009**: 업로드된 파일은 서버에 저장되지 않아야 한다.
- **CON-010**: 프린트 기능은 브라우저 기본 프린트 API를 사용해야 한다.
- **CON-011**: 파일 다운로드는 브라우저 기본 다운로드 메커니즘을 사용해야 한다.
- **CON-015**: Excel 파일에서 처리할 수 있는 단어 수는 최대 20개로 제한되어야 한다.
- **CON-016**: Excel 파일 스키마는 영어 단어(English Word)와 한국어 의미(Korean Meaning) 두 개의 필수 열만 처리하며, 추가 열은 무시해야 한다.

### 4.4. 운영 제약사항

- **CON-012**: Vercel 또는 Netlify 플랫폼에 배포되어야 한다.
- **CON-013**: 환경변수를 통한 설정 관리를 사용해야 한다.
- **CON-014**: 로그는 플랫폼 기본 로깅 시스템을 사용한다.

## 5. 검수 기준

### 5.1. 기능 검수

- [ ] 영어 스토리 생성이 정상적으로 동작한다.
- [ ] 영어 예문 생성이 정상적으로 동작한다.
- [ ] TTS 기능이 모든 지원 브라우저에서 동작한다.
- [ ] HTML 태그 강조 기능이 올바르게 표시된다.
- [ ] 클립보드 복사 기능이 정상적으로 동작한다.
- [ ] 다중 LLM 프로바이더 전환이 자동으로 동작한다.
- [ ] 프린트 출력 기능이 올바른 형식으로 동작한다.
- [ ] Excel 파일 다운로드가 정상적으로 동작한다.
- [ ] Excel 파일 업로드 및 파싱이 정상적으로 동작한다.
- [ ] 잘못된 파일 형식 업로드 시 적절한 오류 메시지가 표시된다.
- [ ] Excel 파일 드래그 앤 드롭 업로드가 정상적으로 동작한다.
- [ ] Excel 파일 미리보기 기능이 올바르게 표시된다.
- [ ] 생성된 Excel 파일을 재업로드하여 재사용할 수 있다.
- [ ] Excel 파일에서 빈 행과 중복 데이터가 적절히 처리된다.
- [ ] Excel 파일 업로드 진행률이 올바르게 표시된다.
- [ ] Excel 파일에서 20개 초과 단어 업로드 시 적절한 제한 처리가 동작한다.
- [ ] Excel 파일 업로드 시 스키마 가이드가 명확하게 표시된다.
- [ ] 잘못된 Excel 스키마 업로드 시 가이드에 따른 오류 메시지가 표시된다.

### 5.2. 성능 검수

- [ ] 시스템 응답 시간이 요구사항을 만족한다.
- [ ] 동시 사용자 부하 테스트를 통과한다.
- [ ] 메모리 사용량이 서버리스 함수 제한 내에 있다.
- [ ] Excel 파일 처리 성능이 요구사항을 만족한다.
- [ ] 프린트 페이지 생성 시간이 요구사항을 만족한다.
- [ ] 대용량 Excel 파일(5MB) 처리가 정상적으로 동작한다.

### 5.3. 보안 검수

- [ ] API 키가 클라이언트에 노출되지 않는다.
- [ ] 입력 검증이 올바르게 수행된다.
- [ ] XSS 공격에 대한 보안이 확보되어 있다.

### 5.4. 품질 검수

- [ ] 테스트 커버리지가 80% 이상이다.
- [ ] 코드 리뷰가 완료되었다.
- [ ] 문서화가 충분히 작성되어 있다.

## 6. 위험 요소 및 대응 방안

### 6.1. 기술적 위험

- **위험**: LLM API 장애
- **대응**: 다중 프로바이더 지원 및 자동 폴백 메커니즘

- **위험**: 브라우저 호환성 문제
- **대응**: 주요 브라우저 테스트 및 점진적 향상(Progressive Enhancement) 적용

- **위험**: 대용량 Excel 파일 처리 시 브라우저 성능 저하
- **대응**: 파일 크기 제한, 청크 단위 처리, 진행률 표시 및 취소 기능 제공

- **위험**: 악성 Excel 파일 업로드
- **대응**: 파일 형식 검증, 크기 제한, 클라이언트 사이드 처리로 서버 부하 방지

### 6.2. 비즈니스 위험

- **위험**: LLM API 비용 증가
- **대응**: 토큰 사용량 모니터링 및 최적화

- **위험**: 품질 저하
- **대응**: 포괄적인 테스트 스위트 및 TDD 적용

### 6.3. 운영 위험

- **위험**: 서버리스 함수 콜드 스타트
- **대응**: 함수 최적화 및 예열 메커니즘

- **위험**: API 키 유출
- **대응**: 환경변수 관리 및 보안 모범 사례 적용

### 6.4. 파일 처리 위험

- **위험**: Excel 파일 파싱 오류로 인한 데이터 손실
- **대응**: 미리보기 기능 제공, 파싱 검증 로직 강화, 오류 시 명확한 안내 메시지

- **위험**: 메모리 부족으로 인한 브라우저 크래시
- **대응**: 파일 크기 제한, 스트리밍 파싱, 메모리 사용량 모니터링

- **위험**: 잘못된 Excel 파일 형식으로 인한 시스템 오류
- **대응**: 엄격한 파일 형식 검증, 예외 처리 강화, 사용자 친화적 오류 메시지

- **위험**: 20개 초과 단어가 포함된 Excel 파일 업로드로 인한 성능 저하
- **대응**: 사전 단어 수 검증, 20개 제한 적용, 명확한 안내 메시지 제공

- **위험**: 잘못된 Excel 스키마로 인한 데이터 인식 오류
- **대응**: 스키마 가이드 제공, 업로드 전 미리보기 기능, 표준 템플릿 다운로드 옵션
